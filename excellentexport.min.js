/**
 * ExcellentExport 2.1.0
 * A client side Javascript export to Excel.
 *
 * @author: Jordi Burgos (jordiburgos@gmail.com)
 * @url: https://github.com/jmaister/excellentexport
 *
 *	FORK by Ricardo Burone (https://github.com/rburone/excellentexport)
 *		ADD: Modif. from rneuber1 (https://github.com/rneuber1/excellentexport)
 *		ADD: File generation for download from javascript
 *			ExcellentExport.excelFile()
 */
!function(e){"use strict"
var t=function(){function e(e,t,n){t=t||"",n=n||512
var o,r=window.atob(e),m=[]
for(o=0;o<r.length;o+=n){var i,a=r.slice(o,o+n),c=new Array(a.length)
for(i=0;i<a.length;i+=1)c[i]=a.charCodeAt(i)
var s=new window.Uint8Array(c)
m.push(s)}return new window.Blob(m,{type:t})}function t(t,n,o,r){var m
if(window.navigator.msSaveBlob)return m=e(n,o),window.navigator.msSaveBlob(m,r),!1
if(window.URL.createObjectURL){m=e(n,o)
var i=window.URL.createObjectURL(m)
t.href=i}else{var a="data:"+o+";base64,"+n
t.download=r,t.href=a}return!0}var n={excel:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>.txt {mso-number-format:"@";} .num {mso-number-format:"0.000";} .nodec {mso-number-format:"0";} .shortdate {mso-number-format:"Short Date";} .meddate {mso-number-format:"Medium Date";} .longdate {mso-number-format:"Long Date";} .gerdate {mso-number-format:"dd.mm.yyyy";} .shorttime {mso-number-format:"Short Time";} .medtime {mso-number-format:"Medium Time";} .longtime {mso-number-format:"Long Time";} .percent2 {mso-number-format:"Percent";}.percent0 {mso-number-format:"0%";}</style></head><body><table>{table}</table></body></html>'},o=",",o=",",r="\r\n",m=function(e){return window.btoa(window.unescape(encodeURIComponent(e)))},i=function(e,t){return e.replace(new RegExp("{(\\w+)}","g"),function(e,n){return t[n]})},a=function(e){return $("#"+e+" table").contents().unwrap(),$("#"+e+" tr").filter(function(){return 1===$(this).children().length}).children("td").attr("colspan","20"),$("#"+e+" th").css({width:"55pt"}),e.nodeType?e:document.getElementById(e)},c=function(e){var t=e,n=-1!==e.indexOf(o)||-1!==e.indexOf("\r")||-1!==e.indexOf("\n"),r=-1!==e.indexOf('"')
return r&&(t=t.replace(/"/g,'""')),(n||r)&&(t='"'+t+'"'),t},s=function(e){var t,n,m,i,a=""
for(t=0;t<e.rows.length;t+=1){for(m=e.rows[t],n=0;n<m.cells.length;n+=1)i=m.cells[n],a=a+(n?o:"")+c(i.textContent.trim())
a+=r}return a}
return{version:function(){return"2.1.0"},excel:function(e,o,r){o=a(o)
var c={worksheet:r||"Worksheet",table:o.innerHTML}
return t(e,m(i(n.excel,c)),"application/vnd.ms-excel","export.xls")},csv:function(e,n,i,c){void 0!==i&&i&&(o=i),void 0!==c&&c&&(r=c),n=a(n)
var l="\ufeff"+s(n)
return t(e,m(l),"application/csv","export.csv")},excelFile:function(e,t,o){t=a(t)
var r={worksheet:o||"Worksheet",table:t.innerHTML}
return new Blob([i(n.excel,r)],{type:"application/vnd.ms-excel"})}}}()
"function"==typeof define&&define.amd?define(function(){return t}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.ExcellentExport=t):e.ExcellentExport=t}(this)
